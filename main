#include <stdio.h>
#include <stdlib.h>
#include "tp4.h"

static void purger(void)

{
    int c;


    while ((c = getchar()) != '\n' && c != EOF)

    {}

}


void main()
{
    int choix, b, CID, annee;
    char nom[NMAX], prenom[NMAX];
    char sexe=' ';
    Benevole *ben;
    Tranche *abr=NULL;
    ListBenevoles *listeHonneur;
    //extern ListeTranche *l;
    Tranche *ty;
    do
    {
    printf("Que voulez vous faire ? : \n1 : Initialiser un arbre\n2 : Ajouter une tranche\n3 : Ajouter un benevole\n4 : Afficher les tranches d'ages\n5 : Afficher les benevoles\n6 : Supprimer un benevole\n7 : Supprimer une tranche\n8 : Afficher les benevoles d'honneur\n9 : Afficher le nombre total de benevoles\n10 : Actualiser l'ABR\n11 : Afficher le pourcentage de benevoles d'une tranche d'age\n12 : Detruire l'arbre\n13 : Quitter \n");
    scanf("%d", &choix);
    switch(choix)
    {
        case 1 : abr=NULL;  //OK
                 printf("L'arbre a bien ete initialise. \n");
                 break;

        case 2 :    printf("Nous allons ajouter un noeud a l'arbre, quelle est la borne superieur ?\n");  //OK
                    scanf("%d", &b);
                    abr=ajoutTranche(abr, b);
                    break;

        case 3 :   // OK
                 printf("saisir le nom\n");
                 scanf("%s", nom);
                 printf("saisir le prenom\n");
                 scanf("%s", prenom);
                 printf("saisir le sexe\n");
                 purger();
                 scanf("%c", &sexe);
                 printf("saisir le CID\n");
                 scanf("%d", &CID);
                 printf("saisir l'annee de naissance\n");
                 scanf("%d", &annee);
                 ben=nouveauBen(nom, prenom, CID, sexe,annee);
                 insererBen(abr, ben);
                 break;

        case 4 : printf("Voici l'arbre dans l'ordre decroissant : \n \n");  //OK
                 afficherArbre(abr);
                 printf("\n");

                 break;

        case 5 : printf("Quelle est la borne superieur de la tranche a afficher ?\n");  //OK
                 scanf("%d", &b);
                 if (chercherTranche(abr, b) == NULL)
                 {
                     printf("Desole, cette tranche n'existe pas. \n");
                 }
                 else
                 {
                     afficherTranche(abr, b);
                 }
                 break;

        case 6 : printf("Quel CIN puis quelle annee de naissance?\n"); // OK ! Mais ne supprime pas la branche si elle est vide !
                 scanf("%d %d", &CID, &annee);
                 //supprimerBen(abr, CID, annee);
                 if (supprimerBen(abr, CID, annee) == 0)
                 {
                     printf("Benevole supprimer avec succes ! \n");
                 }
                 else
                 {
                     printf("Il y a eu une erreur ! \n");
                 }
                 break;

        case 7 : printf("Quelle borne sup ?\n");
                 scanf("%d", &b);
                 supprimerTranche2(abr, b);
                // afficherArbre(abr);
                 break;

        case 8 :  // OK !
                 listeHonneur =BenDhonneur(abr);
                 printf("       nom         |        prenom       | sexe |        CID          | annee \n");
                 afficherBen(listeHonneur->premier);
                 break;

        case 9 : printf("Nombre total de benevoles : %d\n", totalBen(abr));  //OK
                 break;

        case 10 : printf("Nombre de benevoles actualises : %d\n", actualiser(abr));
                  break;

        case 11 :  //OK
                  printf("Quelle borne sup ?\n");
                  scanf("%d", &b);
                  printf("Pourcentage de benevoles entre %d ans et %d ans : %f \n", b-4, b, pourcentageTranche(abr, b));
                  break;

        case 12 : detruire_Arbre(abr);
                abr = NULL;   //pas d'autre solution pour le moment
                    if (abr == NULL)
                 {

                  printf("L'arbre a bien ete supprime ! \n");
                 }
                
                  break;


        case 13 : printf("Au revoir\n");
                  break;


        default : printf("Nombre non reconnu \n");
                  break;

    }
    } while(choix!=13);
}
